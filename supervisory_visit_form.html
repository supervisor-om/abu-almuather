<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุงูุชูููู ุงูุฅุดุฑุงูู ุงูุฑููู ุงููุทูุฑ</title>
    
    <!-- Chart.js for Dashboard -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Script for Word Export Functionality -->
    <script src="https://unpkg.com/html-docx-js/dist/html-docx.js"></script>

    <style>
        /* --- Google Fonts --- */
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');

        /* --- Global Styles --- */
        body { 
            font-family: 'Tajawal', sans-serif; 
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
        }

        /* --- Main Container & Views --- */
        .main-container {
            max-width: 900px;
            margin: auto;
            background-color: #ffffff;
            padding: 25px 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        #form-view, #dashboard-view, #saved-reports-view { display: none; }
        #form-view.active, #dashboard-view.active, #saved-reports-view.active { display: block; }


        /* --- Navigation & Header --- */
        .top-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .nav-tabs {
            display: flex;
            border-bottom: 2px solid #dee2e6;
            flex-grow: 1;
        }
        .nav-tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            font-family: 'Tajawal', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: color 0.2s, border-bottom-color 0.2s;
        }
        .nav-tab:hover { color: #0056b3; }
        .nav-tab.active {
            color: #0056b3;
            font-weight: 700;
            border-bottom-color: #007bff;
        }
       
        /* --- Interactive Form Styles --- */
        .page-header h1 { color: #0056b3; margin: 0; text-align: center;}
        .page-header p { margin: 5px 0 0; color: #666; font-size: 1.1rem; text-align: center;}
        h2 { color: #0056b3; border-right: 4px solid #007bff; padding-right: 10px; margin-top: 30px; }
        details { border: 1px solid #e0e0e0; border-radius: 8px; padding: 10px 15px; margin-bottom: 20px; background-color: #fafafa; }
        summary { cursor: pointer; font-weight: 700; font-size: 1.2rem; color: #0056b3; list-style: none; display: flex; align-items: center; }
        summary::-webkit-details-marker { display: none; }
        summary::before { content: 'โ'; margin-left: 10px; font-size: 0.8em; transition: transform 0.2s; }
        details[open] > summary::before { transform: rotate(90deg); }
        .item-card { border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin: 15px 0; background-color: #fdfdfd; transition: box-shadow 0.3s; }
        .item-card:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.07); }
        .item-header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;}
        .item-header h4 { margin: 0; font-size: 1.1rem; color: #333; flex-grow: 1; }
        .item-header h4 small { color: #555; font-weight: 400; font-size: 0.9rem;}
        .score { font-size: 2rem; font-weight: bold; color: #333; background-color: #f0f2f5; border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; transition: color 0.3s, background-color 0.3s; }
        
        .rating-selector { display: flex; justify-content: space-around; padding: 10px 0; margin-top: 10px; border-top: 1px solid #eee;}
        .rating-btn { padding: 8px 12px; border-radius: 5px; border: 1px solid #ccc; background-color: #f8f9fa; cursor: pointer; transition: all 0.2s; font-size: 0.9rem; }
        .rating-btn:hover { transform: translateY(-2px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .rating-btn.active { font-weight: bold; color: white; border-color: transparent; }
        .rating-btn.active.score-1 { background-color: #155724; }
        .rating-btn.active.score-2 { background-color: #004085; }
        .rating-btn.active.score-3 { background-color: #856404; }
        .rating-btn.active.score-4 { background-color: #721c24; }
        .rating-btn.active.score-5 { background-color: #dc3545; }

        .notes-wrapper { position: relative; }
        .item-notes { width: 100%; box-sizing: border-box; margin-top: 15px; padding: 8px; padding-left: 35px; border: 1px solid #ddd; border-radius: 4px; background-color: #f8f9fa; font-size: 0.95rem; min-height: 80px; }
        .item-notes .highlight { color: red; font-weight: bold; }

        .mic-btn { position: absolute; left: 8px; top: 25px; background: none; border: none; cursor: pointer; font-size: 1.2rem; color: #6c757d; transition: color 0.2s;}
        .mic-btn:hover { color: #007bff; }
        .mic-btn.recording { color: #dc3545; }
        
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; align-items: center;}
        .info-grid input, .info-grid select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; font-family: 'Tajawal', sans-serif; font-size: 1rem; }
        .info-grid .dropdown-wrapper { display: flex; flex-direction: column; gap: 5px; }
        
        .controls { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        .controls button { padding: 10px 20px; font-size: 0.9rem; font-family: 'Tajawal', sans-serif; font-weight: 700; cursor: pointer; border: none; border-radius: 5px; color: white; transition: background-color 0.2s, transform 0.1s; }
        .controls button:hover { transform: translateY(-2px); }
        .print-btn { background-color: #28a745; }
        .reset-btn { background-color: #dc3545; }
        .generate-btn { background-color: #007bff; }
        .archive-btn { background-color: #3f51b5; }
        .export-btn { background-color: #17a2b8; }
        #status-message { text-align: center; color: green; margin-top: 15px; font-weight: 500; height: 20px; transition: opacity 0.5s; }
        .report-section { margin-top: 40px; border-top: 2px solid #007bff; padding-top: 20px; }
        .report-box h3 { color: #0056b3; margin-top: 0; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
        .report-content-area { width: 100%; box-sizing: border-box; border: 1px solid #dee2e6; border-radius: 4px; background-color: #f8f9fa; font-family: inherit; font-size: 1rem; line-height: 1.7; resize: vertical; min-height: 120px; padding: 8px; margin-top: 10px; }
        .visitor-info { margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; }

        /* Template Section Styles */
        .template-section { margin-top: 20px; padding: 15px; border: 1px dashed #007bff; border-radius: 8px; background-color: #f8f9fa;}
        .template-controls { display: flex; gap: 10px; align-items: center; }
        .template-controls select { flex-grow: 1; }

        /* --- Dashboard & Saved Reports Styles --- */
        .dashboard-controls { display: flex; gap: 10px; margin-bottom: 20px; align-items: center; }
        .dashboard-controls input { flex-grow: 1; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-family: 'Tajawal', sans-serif; font-size: 1rem;}
        .dashboard-controls button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        #chart-container { margin-top: 20px; height: 450px; }
        #no-data-message, #no-saved-reports-message { text-align: center; color: #6c757d; font-size: 1.2rem; padding: 40px; }
        .saved-report-card {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        .saved-report-info { font-size: 1.1rem; }
        .saved-report-info strong { color: #0056b3; }
        .saved-report-actions button {
            padding: 8px 12px;
            margin-right: 5px;
        }


        /* --- Custom Modal Styles --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background-color: white; padding: 25px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center; max-width: 400px; width: 90%; }
        .modal-buttons { display: flex; justify-content: center; gap: 15px; }
        .modal-buttons button { padding: 10px 20px; border-radius: 5px; border: none; cursor: pointer; font-weight: 700; }
        #confirm-reset-btn { background-color: #dc3545; color: white; }
        #cancel-reset-btn { background-color: #6c757d; color: white; }

        /* --- Print-Only Styles --- */
        .print-view { display: none; }

        @media print {
            body { background-color: #fff; padding: 0; margin: 0; font-family: 'Times New Roman', Times, serif; }
            .main-container, .modal-overlay { display: none; }
            .print-view { display: block; }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <header class="top-header">
            <nav class="nav-tabs">
                <button class="nav-tab active" onclick="toggleView('form-view')">ูููุฐุฌ ุงูุชูููู</button>
                <button class="nav-tab" onclick="toggleView('dashboard-view')">ููุญุฉ ุงููุชุงุจุนุฉ</button>
                <button class="nav-tab" onclick="toggleView('saved-reports-view')">ุงูุชูุงุฑูุฑ ุงููุญููุธุฉ</button>
            </nav>
        </header>

        <div id="form-view" class="active">
            <div class="page-header">
                <h1>ุงุณุชูุงุฑุฉ ุฒูุงุฑุฉ ุฅุดุฑุงููุฉ ุฅููุชุฑูููุฉ</h1>
                <p>ูุธุงู ุงูุชูููู ุงูุฅุดุฑุงูู ุงูุฑููู ุงููุทูุฑ (ุงูุฑูุงุถุฉ ุงููุฏุฑุณูุฉ)</p>
            </div>
            <main>
                <section class="visit-info">
                    <h2>ูุนูููุงุช ุงูุฒูุงุฑุฉ</h2>
                    <div class="info-grid">
                        <div class="dropdown-wrapper">
                            <select id="school"></select>
                            <input id="school-other" type="text" placeholder="ุฃู ุฃุฏุฎู ุงุณู ุงููุฏุฑุณุฉ ูุฏูููุง" style="display: none; margin-top: 5px;">
                        </div>
                        <input id="teacherName" type="text" placeholder="ุงุณู ุงููุนูู">
                        <input id="fileNumber" type="text" placeholder="ุฑูู ุงูููู">
                        <input id="subject" type="text" placeholder="ุงููุงุฏุฉ" value="ุงูุฑูุงุถุฉ ุงููุฏุฑุณูุฉ">
                        <input id="visitNumber" type="text" placeholder="ุฑูู ุงูุฒูุงุฑุฉ">
                        <input id="visitDate" type="date" placeholder="ุงูุชุงุฑูุฎ">
                        <input id="class" type="text" placeholder="ุงูุตู">
                        <input id="lesson" type="text" placeholder="ุงูุญุตุฉ">
                        <input id="topic" type="text" placeholder="ุงูููุถูุน">
                    </div>
                </section>

                <section class="template-section">
                     <div class="template-controls">
                        <select id="template-select" class="info-grid-input"></select>
                        <button onclick="loadTemplate()" class="generate-btn" style="padding: 8px 12px; font-size: 0.9rem;">ุชุญููู ูุงูุจ</button>
                        <button onclick="saveTemplate()" class="save-btn" style="padding: 8px 12px; font-size: 0.9rem;">ุญูุธ ููุงูุจ</button>
                    </div>
                </section>
                
                <details>
                    <summary>ุงุถุบุท ููุง ูุนุฑุถ ูุนูุงุฑ ุงูุชูููู</summary>
                    <div style="padding: 10px;">
                        <ul>
                            <li><b>1 - ูุชููุฒ</b></li>
                            <li><b>2 - ุฌูุฏ</b></li>
                            <li><b>3 - ููุงุฆู</b></li>
                            <li><b>4 - ุบูุฑ ููุงุฆู</b></li>
                            <li><b>5 - ูุญุชุงุฌ ุฅูู ุชุฏุฎู ุณุฑูุน</b></li>
                        </ul>
                    </div>
                </details>

                <form id="evaluationForm">
                    <!-- Item Cards will be generated by JS -->
                </form>
                
                <section id="reportSection" class="report-section" style="display: none;">
                    <h2>ุงูุชูุฑูุฑ ุงูููุงุฆู</h2>
                    <div class="report-box"><h3>ุฌูุงูุจ ุงูุฅุฌุงุฏุฉ</h3><textarea id="strengthsContent" class="report-content-area" placeholder="..."></textarea></div>
                    <div class="report-box"><h3>ุงูุฌูุงูุจ ุงูุชู ุชุญุชุงุฌ ุฅูู ุชุทููุฑ</h3><textarea id="developmentContent" class="report-content-area" placeholder="..."></textarea></div>
                    <div class="report-box"><h3>ุงูุชูุตูุงุช</h3><textarea id="recommendationsContent" class="report-content-area" placeholder="..."></textarea></div>
                </section>

                <section class="visitor-info">
                    <h2>ูุนูููุงุช ุงูุฒุงุฆุฑ</h2>
                    <div class="info-grid">
                        <input id="visitorName" type="text" placeholder="ุงุณู ุงูุฒุงุฆุฑ">
                        <input id="visitorPosition" type="text" placeholder="ุงููุธููุฉ (ูุซุงู: ูุดุฑู ุชุฑุจูู)">
                    </div>
                </section>
                
                <p id="status-message"></p>

                <section class="controls">
                    <button type="button" class="archive-btn" onclick="savePermanentReport()">ุญูุธ ุงูุชูุฑูุฑ</button>
                    <button type="button" class="generate-btn" onclick="generateReport()">ุชูููุฏ ุชูุฑูุฑ</button>
                    <button class="print-btn" onclick="printOfficialReport()">ุทุจุงุนุฉ</button>
                    <button type="button" class="export-btn" onclick="exportToWord()">ุชุตุฏูุฑ Word</button>
                    <button type="button" class="reset-btn" onclick="showResetModal()">ุฅุนุงุฏุฉ ุชุนููู</button>
                </section>
            </main>
        </div>

        <div id="dashboard-view">
            <h2>ููุญุฉ ูุชุงุจุนุฉ ุฃุฏุงุก ุงููุนูู</h2>
            <div class="dashboard-controls">
                <input type="text" id="teacher-dashboard-name" placeholder="ุฃุฏุฎู ุงุณู ุงููุนูู ูุนุฑุถ ุจูุงูุงุชู...">
                <button onclick="loadTeacherDashboard()">ุนุฑุถ ุงูุฃุฏุงุก</button>
            </div>
            <div id="chart-container">
                <canvas id="performanceChart"></canvas>
            </div>
            <div id="no-data-message" style="display: none;">
                <p>ูุง ุชูุฌุฏ ุจูุงูุงุช ูุญููุธุฉ ููุฐุง ุงููุนูู ุญุชู ุงูุขู.</p>
            </div>
        </div>

        <div id="saved-reports-view">
            <h2>ุงูุชูุงุฑูุฑ ุงููุญููุธุฉ</h2>
            <p>ููุง ููููู ุนุฑุถ ูุชุญููู ุงูุชูุงุฑูุฑ ุงูุชู ุชู ุญูุธูุง ุจุดูู ุฏุงุฆู.</p>
            <div id="saved-reports-list">
                <!-- Reports will be injected here -->
            </div>
            <div id="no-saved-reports-message" style="display: none;">
                <p>ูุง ุชูุฌุฏ ุชูุงุฑูุฑ ูุญููุธุฉ ุญุชู ุงูุขู.</p>
            </div>
        </div>
    </div>
    
    <!-- Modals and Print View -->
    <div id="reset-modal" class="modal-overlay">
        <div class="modal-content">
            <h3>ุชุฃููุฏ ุฅุนุงุฏุฉ ุงูุชุนููู</h3>
            <p>ูู ุฃูุช ูุชุฃูุฏ ูู ุฑุบุจุชู ูู ุฅุนุงุฏุฉ ุชุนููู ูุงูุฉ ุงูุญูููุ ุณูุชู ููุฏุงู ุฌููุน ุงูุจูุงูุงุช ุงููุฏุฎูุฉ.</p>
            <div class="modal-buttons">
                <button id="confirm-reset-btn" onclick="performReset()">ุชุฃููุฏ</button>
                <button id="cancel-reset-btn" onclick="hideResetModal()">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>
    <div class="print-view" id="printView">
        <div class="print-container">
             <div class="print-logo-header">
                <img src="https://j.top4top.io/p_35222ql0t1.png" alt="ุดุนุงุฑ ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ" class="logo" onerror="this.style.display='none'">
                <img src="https://k.top4top.io/p_3522wfvvr2.png" alt="ุดุนุงุฑ ุฑุคูุฉ ุนูุงู 2040" class="logo" onerror="this.style.display='none'">
                <img src="https://l.top4top.io/p_35225xfin3.png" alt="ุดุนุงุฑ ุงูุฌูุฏุฉ" class="logo" onerror="this.style.display='none'">
            </div>
            <div class="print-header-text">ูููุฐุฌ ุฑูู (5) ุงุณุชูุงุฑุฉ ุฒูุงุฑุฉ ุฅุดุฑุงููุฉ ููุนูู ูุงุฏุฉ - ูุฌุงู</div>
            <div class="print-title"><h2>ุงุณุชูุงุฑุฉ ุฒูุงุฑุฉ ุฅุดุฑุงููุฉ ููุนูู ูุงุฏุฉ/ูุฌุงู</h2></div>
            
            <table class="print-info-table">
                <tbody>
                    <tr><td class="label">ุงุณู ุงููุนูู:</td><td class="value" id="print-teacherName"></td><td class="label">ุงููุฏุฑุณุฉ:</td><td class="value" id="print-school"></td></tr>
                    <tr><td class="label">ุงููุงุฏุฉ/ุงููุฌุงู:</td><td class="value" id="print-subject"></td><td class="label">ุฑูู ุงูููู:</td><td class="value" id="print-fileNumber"></td></tr>
                    <tr><td class="label">ุงูุชุงุฑูุฎ:</td><td class="value" id="print-visitDate"></td><td class="label">ุฑูู ุงูุฒูุงุฑุฉ:</td><td class="value" id="print-visitNumber"></td></tr>
                    <tr><td class="label">ุงูุญุตุฉ:</td><td class="value" id="print-lesson"></td><td class="label">ุงูุตู:</td><td class="value" id="print-class"></td></tr>
                    <tr><td class="label">ุงูููุถูุน:</td><td colspan="3" class="value" id="print-topic"></td></tr>
                </tbody>
            </table>
            
            <table class="print-main-table">
                <thead>
                    <tr>
                        <th style="width: 20%;">ุงููุฌุงู</th>
                        <th style="width: 15%;">ุงููุนูุงุฑ</th>
                        <th style="width: 3%;">ู</th>
                        <th>ุงูุจูุฏ</th>
                        <th style="width: 7%;">ุงูุชูุฏูุฑ</th>
                    </tr>
                </thead>
                <tbody id="print-main-tbody">
                    <!-- Rows generated by script -->
                </tbody>
            </table>

            <div class="report-section-print">
                <h3>ุฌูุงูุจ ุงูุฅุฌุงุฏุฉ ูู ุงูุฃุฏุงุก ูุฃุฏูุชูุง:</h3>
                <div id="print-strengthsContent" class="print-report-box"></div>
            </div>
            <div class="report-section-print">
                <h3>ุงูุฌูุงูุจ ุงูุชู ุชุญุชุงุฌ ุฅูู ุชุทููุฑ ูู ุงูุฃุฏุงุก ูุฃุฏูุชูุง:</h3>
                <div id="print-developmentContent" class="print-report-box"></div>
            </div>
            <div class="report-section-print">
                <h3>ุงูุชูุตูุงุช:</h3>
                <div id="print-recommendationsContent" class="print-report-box"></div>
            </div>

            <div class="signature-section">
                ุงุณู ุงูุฒุงุฆุฑ: <span id="print-visitorName" class="line"></span><br><br>
                ุงููุธููุฉ: <span id="print-visitorPosition" class="line"></span>
            </div>
            <div class="evaluation-standard">
                โ ูุนูุงุฑ ุงูุชูููู: 1- ูุชููุฒุ 2- ุฌูุฏุ 3- ููุงุฆูุ 4- ุบูุฑ ููุงุฆูุ 5- ูุญุชุงุฌ ุฅูู ุชุฏุฎู ุณุฑูุน
            </div>
        </div>
    </div>

    <script>
        // --- Globals & Constants ---
        let performanceChartInstance;
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = SpeechRecognition ? new SpeechRecognition() : null;
        if (recognition) {
            recognition.continuous = false;
            recognition.lang = 'ar-SA';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;
        }

        const schoolsList = [
            "ุฃุจู ุงููุงุณู ุงูุฒูุฑุงูู", "ุฃุจู ุฃููุจ ุงูุญุถุฑูู", "ุฃุจู ุชูุงู", "ุฃุญูุฏ ุจู ุงููุนูุงู", 
            "ุงูุดูุฎ ุณุงูู ุงูุณูุงุจู", "ุงูุดูุฎ ุณุนูุฏ ุงูููุฏู ูุณุงูู", "ุงูุดูุฎ ูุงุตุฑ ุงูุฎุฑูุตู", 
            "ุฌูุงุฏุฉ ุงูุงุฒุฏู", "ุญูุต ุจู ุฑุงุดุฏ", "ุฎุฑูุณ ุงูุญุจูุณ", "ุณููู ุจู ุนูุฑู ุงูุนุงูุฑู", 
            "ูุนุจ ุจู ุฒูุฏ", "ูุฒูุฏ ุงูุทุงุฆู", "ุฃุฌูุงู ุงูุซูุงูุฉ", "ุฃุฌูุงู ุงููุฑุฏูุณ โ ุงูุญูู", 
            "ุงูุจูุงู", "ุงูุฌูู ุงููุจุฏุน", "ุงูุฑูุงุฏุฉ", "ุงูุตููุฉ -ุงููุนุจููุฉ", "ุงููุฌุฏ", 
            "ุฌููุฑ ุจู ุงูุฌููุฏู", "ุงูุณุฑุงุฌ", "ุถูุงุก ุงููุณุชูุจู", "ูุดุงุนู ูุณูุท ุณูุฑ ุงู ุญุฏูุฏ"
        ];

        const evaluationItems = [
            { id: 1, domain: 'ุงูุฅูุฌุงุฒ ุงูุฏุฑุงุณู', standard: 'ุงูุชุญุตูู ุงูุฏุฑุงุณู', title: 'ุชุญุตูู ุงูุทูุจุฉ ูู ุงูุฃุนูุงู ุงูุตููุฉ ูุบูุฑ ุงูุตููุฉ', desc: '(ุงูุชุณุงุจ ุงูููุงุฑุงุช ุงูุญุฑููุฉ ูุงููุนุงุฑู ุงููุฑุชุจุทุฉ ุจูุง)' },
            { id: 2, domain: 'ุงูุฅูุฌุงุฒ ุงูุฏุฑุงุณู', standard: 'ุงูุชูุฏู ุงูุฏุฑุงุณู', title: 'ุงูุชูุฏู ุงูุฏุฑุงุณู ููุทูุจุฉ ุจูุง ูููู ุงูุทูุจุฉ ุฐูู ุงูุฅุนุงูุฉ/ุงูุงุญุชูุงุฌุงุช ุงูุชุนููููุฉ', desc: '(ุชุทูุฑ ุงูุฃุฏุงุก ุงูููุงุฑู ูุงูุฎุทุทู)' },
            { id: 3, domain: 'ุงูุฅูุฌุงุฒ ุงูุฏุฑุงุณู', standard: 'ููุงุฑุงุช ุงูุชุนูู', title: 'ุชุทุจูู ููุงุฑุงุช ุงูุชุนูู (ุงูุฐุงุชู- ุงูุชุนุงููู - ุงูุฑููู - ุงูุชูููุฑ ุงูุนููุง) ูุฑุจุทูุง ุจุงููุงูุน', desc: '(ุงูููุงุฏุฉุ ุงูุชุนุงููุ ุงูุชูููุฑ ุงูุฎุทุทู ูู ููุงูู ุงููุนุจ)' },
            { id: 4, domain: 'ุงูููู ุงูุดุฎุตู', standard: 'ุงูููู ูุงูุณููู', title: 'ุชูุณู ุงูุทูุจุฉ ุจุงููููุฉ ุงูุนูุงููุฉ ูุงูููู ุงูุฅูุณุงููุฉ', desc: '(ุงูุฑูุญ ุงูุฑูุงุถูุฉ ูุฃุฎูุงููุงุช ุงููุนุจ)' },
            { id: 5, domain: 'ููุงุฎ ุงููุฏุฑุณุฉ ูุจูุฆุฉ ุงูุชุนูู', standard: 'ุฌูุฏุฉ ุจูุฆุฉ ุงูุชุนูู', title: 'ูุชุงุจุนุฉ ุฌูุงูุจ ุงูุฃูู ูุงูุณูุงูุฉ ูุงููุธุงูุฉ ูู ุจูุฆุฉ ุงูุชุนูู', desc: '(ุณูุงูุฉ ุงูุฃุฏูุงุช ูุงููุฑุงูู ุงูุฑูุงุถูุฉ)' },
            { id: 6, domain: 'ุงูุชุฏุฑูุณ ูุงูุชูููู', standard: 'ุชุฎุทูุท ุงููููุงุฌ ุงูุฏุฑุงุณู', title: 'ุชุฎุทูุท ุงููููุงุฌ ุงูุฏุฑุงุณู ูุชุญููู ููุงุชุฌ ุงูุชุนูู', desc: '(ุงูุชุฎุทูุท ูุชูููุฉ ุงูููุงุฑุงุช ุงูุญุฑููุฉ ูุงูููุงูุฉ ุงูุจุฏููุฉ)' },
            { id: 7, domain: 'ุงูุชุฏุฑูุณ ูุงูุชูููู', standard: 'ุฅุฏุงุฑุฉ ุงูุตู', title: 'ูุงุนููุฉ ุงูุฅุฏุงุฑุฉ ุงูุตููุฉ', desc: '(ุฅุฏุงุฑุฉ ูุชูุธูู ุงููุดุงุท ุงูุจุฏูู)' },
            { id: 8, domain: 'ุงูุชุฏุฑูุณ ูุงูุชูููู', standard: 'ูุงุนููุฉ ุงูุชุฏุฑูุณ', title: 'ุชูุธูู ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณ ุงููุนุงูุฉ', desc: '(ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณ ุงูููุงุณุจุฉ ูููุดุงุท ุงูุจุฏูู)' },
            { id: 9, domain: 'ุงูุชุฏุฑูุณ ูุงูุชูููู', standard: 'ูุงุนููุฉ ุงูุชุฏุฑูุณ', title: 'ุชูุนูู ุงููุตุงุฏุฑ ูุงูููุงุฑุฏ ุงูุชุนููููุฉ', desc: '(ุงูุฃุฏูุงุช ูุงูุฃุฌูุฒุฉ ูุงููุฑุงูู ุงูุฑูุงุถูุฉ)' },
            { id: 10, domain: 'ุงูุชุฏุฑูุณ ูุงูุชูููู', standard: 'ุงูุชูููู ููุณุงูุฏุฉ ุงูุชูุฏู', title: 'ุชูุธูู ุฃุณุงููุจ ุชูููู ูุชููุนุฉ', desc: '(ุชูููู ุงูุฃุฏุงุก ุงูุญุฑูู ูุงูููุงุฑู ููุทูุจุฉ)' },
            { id: 11, domain: 'ุงูููุงุฏุฉ ูุงูุฅุฏุงุฑุฉ ูุงูุญูููุฉ', standard: 'ููุงุฏุฉ ุงูุชุบููุฑ', title: 'ุชูุธูู ุงูุชูููู ุงูุฐุงุชู ูุงูุชุทููุฑ ุงููููู ูู ุชุญุณูู ุงูุฃุฏุงุก', desc: '(ุงูุชุฃูู ูู ุงูููุงุฑุณุงุช ุงูุชุฏุฑูุณูุฉ ูุชุทููุฑูุง)' },
            { id: 12, domain: 'ุงูููุงุฏุฉ ูุงูุฅุฏุงุฑุฉ ูุงูุญูููุฉ', standard: 'ุงูุญูููุฉ', title: 'ุชุทุจูู ุงูุณูุงุณุงุช ูุงูุฃูุธูุฉ ูุงูููุงุฆุญ ุงูููุธูุฉ ููุนูู', desc: '(ุงูุงูุชุฒุงู ุจุฃุฎูุงููุงุช ุงููููุฉ ูุงูููุงุฆุญ)' },
            { id: 13, domain: 'ุงูููุงุฏุฉ ูุงูุฅุฏุงุฑุฉ ูุงูุญูููุฉ', standard: 'ุงูุญูููุฉ', title: 'ุชูููุฐ ูุจุงุฏุฑุงุช ูุฃูุดุทุฉ ุชุฑุจููุฉ ูู ุงููุฌุชูุน ุงููุฏุฑุณู', desc: '(ุชูุธูู ุงููุนุงููุงุช ูุงููุณุงุจูุงุช ุงูุฑูุงุถูุฉ)' }
        ];

        const detailedDescriptions = {
            '1': { // ุงูุชุญุตูู ุงูุฏุฑุงุณู
                '1': "ููุชุณุจ <span class='highlight'>ุฌููุน</span> ุงูุทูุจุฉ ุงูููุงุฑุงุช ุงูุฃุณุงุณูุฉ ูุงููุนุงุฑู ูุงูููุงููู ูู ุถูุก ุฃูุฏุงู ุงูุฏุฑุณ ุจุตูุฑุฉ ูุนุงูุฉ.",
                '2': "ููุชุณุจ <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ุงูููุงุฑุงุช ุงูุฃุณุงุณูุฉ ูุงููุนุงุฑู ูุงูููุงููู ูู ุถูุก ุฃูุฏุงู ุงูุฏุฑุณ ุจุตูุฑุฉ ูุงุนูุฉ.",
                '3': "ููุชุณุจ <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ุงูููุงุฑุงุช ุงูุฃุณุงุณูุฉ ูุงููุนุงุฑู ูุงูููุงููู ูู ุถูุก ุฃูุฏุงู ุงูุฏุฑุณ ุจุตูุฑุฉ ููุงุฆูุฉ ุฃู ููุจููุฉ.",
                '4': "ููุชุณุจ <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ุงูููุงุฑุงุช ุงูุฃุณุงุณูุฉ ูุงููุนุงุฑู ูุงูููุงููู ูู ุถูุก ุฃูุฏุงู ุงูุฏุฑุณ ุจุตูุฑุฉ ูุญุฏูุฏุฉ.",
                '5': "ููุชุณุจ <span class='highlight'>ุนุฏุฏ ูุงุฏุฑ ูู</span> ุงูุทูุจุฉ ุงูููุงุฑุงุช ุงูุฃุณุงุณูุฉ ูุงููุนุงุฑู ูุงูููุงููู ูู ุถูุก ุฃูุฏุงู ุงูุฏุฑุณ ุจุตูุฑุฉ ูุญุฏูุฏุฉ ุฌุฏุง / ูุงุฏุฑุฉ."
            },
            '2': { // ุงูุชูุฏู ุงูุฏุฑุงุณู
                '1': "ูุชูุฏู <span class='highlight'>ุฌููุน</span> ุงูุทูุจุฉ ุฏุฑุงุณูุง ุฃุซูุงุก ุงูุญุตุฉ ุจูุง ูููู ุงูุทูุจุฉ ุฐูู ุงูุฅุนุงูุฉ/ุงูุงุญุชูุงุฌุงุช ุงูุชุนููููุฉ ุจุตูุฑุฉ ูุชููุฒุฉ.",
                '2': "ูุชูุฏู <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ุฏุฑุงุณูุง ุฃุซูุงุก ุงูุญุตุฉ ุจูุง ูููู ุงูุทูุจุฉ ุฐูู ุงูุฅุนุงูุฉ/ุงูุงุญุชูุงุฌุงุช ุงูุชุนููููุฉ ุจุตูุฑุฉ ูุงุนูุฉ.",
                '3': "ูุชูุฏู <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ุฏุฑุงุณูุง ุฃุซูุงุก ุงูุญุตุฉ ุจูุง ูููู ุงูุทูุจุฉ ุฐูู ุงูุฅุนุงูุฉ/ุงูุงุญุชูุงุฌุงุช ุงูุชุนููููุฉ ุจุตูุฑุฉ ููุงุฆูุฉ.",
                '4': "ูุชูุฏู <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ุฏุฑุงุณูุง ุฃุซูุงุก ุงูุญุตุฉ ุจูุง ูููู ุงูุทูุจุฉ ุฐูู ุงูุฅุนุงูุฉ/ุงูุงุญุชูุงุฌุงุช ุงูุชุนููููุฉ ุจุตูุฑุฉ ูุญุฏูุฏุฉ.",
                '5': "ูุชูุฏู <span class='highlight'>ุนุฏุฏ ูุงุฏุฑ ูู</span> ุงูุทูุจุฉ ุฏุฑุงุณูุง ุฃุซูุงุก ุงูุญุตุฉ ุจูุง ูููู ุงูุทูุจุฉ ุฐูู ุงูุฅุนุงูุฉ/ุงูุงุญุชูุงุฌุงุช ุงูุชุนููููุฉ ุจุตูุฑุฉ ูุญุฏูุฏุฉ ุฌุฏุง."
            },
            '3': { // ููุงุฑุงุช ุงูุชุนูู
                '1': "ูุทุจู <span class='highlight'>ุฌููุน</span> ุงูุทูุจุฉ ููุงุฑุงุช ุงูุชุนูู ุงูุฐุงุชู ูุงูุชุนุงููู ูุงูุฑููู ูููุงุฑุงุช ุงูุชูููุฑ ุงูุนููุง ุจูุณุชูู ูุชููุฒ.",
                '2': "ูุทุจู <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ููุงุฑุงุช ุงูุชุนูู ุงูุฐุงุชู ูุงูุชุนุงููู ูุงูุฑููู ูููุงุฑุงุช ุงูุชูููุฑ ุงูุนููุง ุจูุณุชูู ูุงุนู.",
                '3': "ูุทุจู <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ููุงุฑุงุช ุงูุชุนูู ุงูุฐุงุชู ูุงูุชุนุงููู ูุงูุฑููู ูููุงุฑุงุช ุงูุชูููุฑ ุงูุนููุง ุจูุณุชูู ููุงุฆู ุฃู ููุงุณุจ.",
                '4': "ูุทุจู <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ููุงุฑุงุช ุงูุชุนูู ุงูุฐุงุชู ูุงูุชุนุงููู ูุงูุฑููู ูููุงุฑุงุช ุงูุชูููุฑ ุงูุนููุง ุจูุณุชูู ูุญุฏูุฏ.",
                '5': "ูุทุจู <span class='highlight'>ุนุฏุฏ ูุงุฏุฑ ูู</span> ุงูุทูุจุฉ ููุงุฑุงุช ุงูุชุนูู ุงูุฐุงุชู ูุงูุชุนุงููู ูุงูุฑููู ูููุงุฑุงุช ุงูุชูููุฑ ุงูุนููุง ุจูุณุชูู ูุญุฏูุฏ ุฌุฏุง/ูุงุฏุฑ."
            },
             '4': { // ุงูููู ูุงูุณููู
                '1': "ููุชุฒู <span class='highlight'>ุฌููุน</span> ุงูุทูุจุฉ ุจุงูููู ุงูุฅูุณุงููุฉ ุงููุดุชุฑูุฉ ููุฑุงุนูู ุฐูู ุจูุณุชูู ูุชููุฒ.",
                '2': "ููุชุฒู <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ุจุงูููู ุงูุฅูุณุงููุฉ ุงููุดุชุฑูุฉ ููุฑุงุนูู ุฐูู ุจูุณุชูู ูุงุนู.",
                '3': "ููุชุฒู <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ุจุงูููู ุงูุฅูุณุงููุฉ ุงููุดุชุฑูุฉุ ููุฑุงุนูู ุฐูู ุจูุณุชูู ููุงุฆู / ููุงุณุจ.",
                '4': "ููุชุฒู <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ุจุงูููู ุงูุฅูุณุงููุฉ ุงููุดุชุฑูุฉุ ููุฑุงุนูู ุฐูู ุจูุณุชูู ูุญุฏูุฏ.",
                '5': "ููุชุฒู <span class='highlight'>ุนุฏุฏ ูุญุฏูุฏ ุฌุฏุง</span> ูู ุงูุทูุจุฉ ุจุงูููู ุงูุฅูุณุงููุฉ ุงููุดุชุฑูุฉ ููุฑุงุนูู ุฐูู ุจูุณุชูู ูุญุฏูุฏ ุฌุฏุง ููุงุฏุฑ."
            },
            '5': { // ุฌูุฏุฉ ุจูุฆุฉ ุงูุชุนูู
                '1': "ูุชุงุจุน ุงููุนูู ุฌูุงูุจ ุงูุฃูู ูุงูุณูุงูุฉ ูุงููุธุงูุฉ ูู ุจูุฆุฉ ุงูุชุนูู ุจุตูุฑุฉ <span class='highlight'>ูุชููุฒุฉ</span>.",
                '2': "ูุชุงุจุน ุงููุนูู ุฌูุงูุจ ุงูุฃูู ูุงูุณูุงูุฉ ูุงููุธุงูุฉ ูู ุจูุฆุฉ ุงูุชุนูู ุจุตูุฑุฉ <span class='highlight'>ุฌูุฏุฉ</span>.",
                '3': "ูุชุงุจุน ุงููุนูู ุฌูุงูุจ ุงูุฃูู ูุงูุณูุงูุฉ ูุงููุธุงูุฉ ูู ุจูุฆุฉ ุงูุชุนูู ุจุตูุฑุฉ <span class='highlight'>ููุงุณุจุฉ</span>.",
                '4': "ูุชุงุจุน ุงููุนูู ุฌูุงูุจ ุงูุฃูู ูุงูุณูุงูุฉ ูุงููุธุงูุฉ ูู ุจูุฆุฉ ุงูุชุนูู ุจุตูุฑุฉ <span class='highlight'>ูุญุฏูุฏุฉ</span>.",
                '5': "ูุชุงุจุน ุงููุนูู ุฌูุงูุจ ุงูุฃูู ูุงูุณูุงูุฉ ูุงููุธุงูุฉ ูู ุจูุฆุฉ ุงูุชุนูู ุจุตูุฑุฉ <span class='highlight'>ูุงุฏุฑุฉ/ููุนุฏูุฉ</span>."
            },
            '6': { // ุชุฎุทูุท ุงููููุงุฌ
                '1': "ูุฎุทุท ุงููุนูู <span class='highlight'>ูุฌููุน</span> ุฏุฑูุณู ูุชุณูุณูุง ูู ุชููุน ุงูุฃูุฏุงู ูุฑุชุจุทุง ุจุงูุฎุทุฉ ุงููุตููุฉ ููุญููุง ูููุงุชุฌ ุงูุชุนูู ุจุตูุฑุฉ ูุชููุฒุฉ.",
                '2': "ูุฎุทุท ุงููุนูู <span class='highlight'>ูุนุธู</span> ุฏุฑูุณู ูุชุณูุณูุง ูู ุชููุน ุงูุฃูุฏุงู ูุฑุชุจุทุง ุจุงูุฎุทุฉ ุงููุตููุฉ ููุญููุง ูููุงุชุฌ ุงูุชุนูู ุจุตูุฑุฉ ุฌูุฏุฉ.",
                '3': "ูุฎุทุท ุงููุนูู <span class='highlight'>ุฃุบูุจ</span> ุฏุฑูุณู ูุชุณูุณูุง ูู ุชููุน ุงูุฃูุฏุงู ูุฑุชุจุทุง ุจุงูุฎุทุฉ ุงููุตููุฉ ููุญููุง ูููุงุชุฌ ุงูุชุนูู ุจุตูุฑุฉ ููุงุณุจุฉ.",
                '4': "ูุฎุทุท ุงููุนูู <span class='highlight'>ูููู ูู</span> ุฏุฑูุณู ูุชุณูุณูุง ูู ุชููุน ุงูุฃูุฏุงู ูุฑุชุจุทุง ุจุงูุฎุทุฉ ุงููุตููุฉ ููุญููุง ูููุงุชุฌ ุงูุชุนูู ุจุตูุฑุฉ ูุญุฏูุฏุฉ.",
                '5': "ูุฎุทุท ุงููุนูู <span class='highlight'>ุนุฏุฏ ูุญุฏูุฏ ุฌุฏุง</span> ูู ุฏุฑูุณู ูุชุณูุณูุง ูู ุชููุน ุงูุฃูุฏุงู ูุฑุชุจุทุง ุจุงูุฎุทุฉ ุงููุตููุฉ ููุญููุง ูููุงุชุฌ ุงูุชุนูู ุจุตูุฑุฉ ูุงุฏุฑุฉ."
            },
            '7': { // ุฅุฏุงุฑุฉ ุงูุตู
                '1': "ูููู ุงููุนูู ุจุฅุฏุงุฑุฉ ุฒูู ุงูุชุนููุ ูุณููู ุทูุจุชู ููุซูุฑ ุฏุงูุนูุชูู ููุชุนูู ุจุตูุฑุฉ <span class='highlight'>ูุนุงูุฉ</span>.",
                '2': "ูููู ุงููุนูู ุจุฅุฏุงุฑุฉ ุฒูู ุงูุชุนููุ ูุณููู ุทูุจุชู ููุซูุฑ ุฏุงูุนูุชูู ููุชุนูู ุจุตูุฑุฉ <span class='highlight'>ุฌูุฏุฉ</span>.",
                '3': "ูููู ุงููุนูู ุจุฅุฏุงุฑุฉ ุฒูู ุงูุชุนููุ ูุณููู ุทูุจุชู ููุซูุฑ ุฏุงูุนูุชูู ููุชุนูู ุจุตูุฑุฉ <span class='highlight'>ููุงุฆูุฉ</span>.",
                '4': "ูููู ุงููุนูู ุจุฅุฏุงุฑุฉ ุฒูู ุงูุชุนููุ ูุณููู ุทูุจุชู ููุซูุฑ ุฏุงูุนูุชูู ููุชุนูู ุจุตูุฑุฉ <span class='highlight'>ูุญุฏูุฏุฉ</span>.",
                '5': "ูููู ุงููุนูู ุจุฅุฏุงุฑุฉ ุฒูู ุงูุชุนููุ ูุณููู ุทูุจุชู ููุซูุฑ ุฏุงูุนูุชูู ููุชุนูู ุจุตูุฑุฉ <span class='highlight'>ูุงุฏุฑุฉ</span>."
            },
            '8': { // ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณ
                '1': "ุชูุธูู ุงุณุชุฑุงุชูุฌูุงุช ุชุฏุฑูุณ ูุนุงูุฉ ุจุญูุซ ูุณุชููุฏ ูููุง ุฌููุน ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ูุชููุฒ.",
                '2': "ููุธู ุงููุนูู ุงุณุชุฑุงุชูุฌูุงุช ุชุฏุฑูุณ ูุนุงูุฉ ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ูุงุนู.",
                '3': "ููุธู ุงููุนูู ุงุณุชุฑุงุชูุฌูุงุช ุชุฏุฑูุณ ูุนุงูุฉ ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ููุงุฆู.",
                '4': "ููุธู ุงููุนูู ุงุณุชุฑุงุชูุฌูุงุช ุชุฏุฑูุณ ูุนุงูุฉ ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ูุญุฏูุฏ.",
                '5': "ููุธู ุงููุนูู ุงุณุชุฑุงุชูุฌูุงุช ุชุฏุฑูุณ ูุนุงูุฉ ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ุนุฏุฏ ูููู ุฌุฏุง</span> ูู ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ูุงุฏุฑ."
            },
             '9': { // ุงููุตุงุฏุฑ ูุงูููุงุฑุฏ
                '1': "ููุนู ุงููุนูู ุงูุชูููุงุช ุงูุฑูููุฉ ูุงูููุตุงุช ูุงูุณุจูุฑุงุช ุงูุชูุงุนููุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ุฌููุน</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ูุชููุฒ.",
                '2': "ููุนู ุงููุนูู ุงูุชูููุงุช ุงูุฑูููุฉ ูุงูููุตุงุช ูุงูุณุจูุฑุงุช ุงูุชูุงุนููุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ุฌูุฏ.",
                '3': "ููุนู ุงููุนูู ุงูุชูููุงุช ุงูุฑูููุฉ ูุงูููุตุงุช ูุงูุณุจูุฑุงุช ุงูุชูุงุนููุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ููุงุฆู.",
                '4': "ููุนู ุงููุนูู ุงูุชูููุงุช ุงูุฑูููุฉ ูุงูููุตุงุช ูุงูุณุจูุฑุงุช ุงูุชูุงุนููุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ูุญุฏูุฏ.",
                '5': "ููุนู ุงููุนูู ุงูุชูููุงุช ุงูุฑูููุฉ ูุงูููุตุงุช ูุงูุณุจูุฑุงุช ุงูุชูุงุนููุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุญูุซ ูุณุชููุฏ ูููุง <span class='highlight'>ูููู ุฌุฏุง ูู</span> ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ุจูุณุชูู ูุงุฏุฑ."
            },
            '10': { // ุฃุณุงููุจ ุงูุชูููู
                '1': "ููุธู ุงููุนูู ุฃุณุงููุจ ุชูููู ูุชููุนุฉุ ูุฑุงุนู ุงูุชูุงูุฒ ุจูู <span class='highlight'>ุฌููุน</span> ุงูุทูุจุฉ ุจูุง ููุนูุณ ุนูู ุชุนูููู ุจูุณุชูู ูุชููุฒ.",
                '2': "ููุธู ุงููุนูู ุฃุณุงููุจ ุชูููู ูุชููุนุฉุ ูุฑุงุนู ุงูุชูุงูุฒ ุจูู <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ุจูุง ููุนูุณ ุนูู ุชุนูููู ุจูุณุชูู ูุงุนู.",
                '3': "ููุธู ุงููุนูู ุฃุณุงููุจ ุชูููู ูุชููุนุฉุ ูุฑุงุนู ุงูุชูุงูุฒ ุจูู <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ุจูุง ููุนูุณ ุนูู ุชุนูููู ุจูุณุชูู ููุงุฆู.",
                '4': "ููุธู ุงููุนูู ุฃุณุงููุจ ุชูููู ูุชููุนุฉุ ูุฑุงุนู ุงูุชูุงูุฒ ุจูู <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ุจูุง ููุนูุณ ุนูู ุชุนูููู ุจูุณุชูู ูุญุฏูุฏ.",
                '5': "ููุธู ุงููุนูู ุฃุณุงููุจ ุชูููู ูุชููุนุฉุ ูุฑุงุนู ุงูุชูุงูุฒ ุจูู <span class='highlight'>ูููู ุฌุฏุง ูู</span> ุงูุทูุจุฉ ุจูุง ููุนูุณ ุนูู ุชุนูููู ุจูุณุชูู ูุงุฏุฑ."
            },
            '11': { // ุงูุชูููู ุงูุฐุงุชู
                '1': "ูุฌุฑู ุงููุนูู ุชููููุง ูุฃุฏุงุฆู ุฐุงุชูุง ูููุธูู ูู ุชุญุณูู ุชุนูู <span class='highlight'>ุฌููุน</span> ุงูุทูุจุฉ ุจูุณุชูู ูุชููุฒ.",
                '2': "ูุฌุฑู ุงููุนูู ุชููููุง ูุฃุฏุงุฆู ุฐุงุชูุง ูููุธูู ูู ุชุญุณูู ุชุนูู <span class='highlight'>ูุนุธู</span> ุงูุทูุจุฉ ุจูุณุชูู ูุงุนู.",
                '3': "ูุฌุฑู ุงููุนูู ุชููููุง ูุฃุฏุงุฆู ุฐุงุชูุง ูููุธูู ูู ุชุญุณูู ุชุนูู <span class='highlight'>ุฃุบูุจ</span> ุงูุทูุจุฉ ุจูุณุชูู ููุงุณุจ.",
                '4': "ูุฌุฑู ุงููุนูู ุชููููุง ูุฃุฏุงุฆู ุฐุงุชูุง ูููุธูู ูู ุชุญุณูู ุชุนูู <span class='highlight'>ูููู ูู</span> ุงูุทูุจุฉ ุจูุณุชูู ูุญุฏูุฏ.",
                '5': "ูุฌุฑู ุงููุนูู ุชููููุง ูุฃุฏุงุฆู ุฐุงุชูุง ูููุธูู ูู ุชุญุณูู ุชุนูู <span class='highlight'>ูููู ุฌุฏุง ูู</span> ุงูุทูุจุฉ ุจูุณุชูู ูุงุฏุฑ."
            },
            '12': { // ุงูุณูุงุณุงุช ูุงูุฃูุธูุฉ
                '1': "ูุทุจู ุงูุณูุงุณุงุช ูุงูุฃูุธูุฉ ูุงูููุงุฆุญ ุงูููุธูุฉ ููุนูู ุจุตูุฑุฉ <span class='highlight'>ูุนุงูุฉ</span>.",
                '2': "ูุทุจู ุงูุณูุงุณุงุช ูุงูุฃูุธูุฉ ูุงูููุงุฆุญ ุงูููุธูุฉ ููุนูู ุจุตูุฑุฉ <span class='highlight'>ูุงุนูุฉ</span>.", // Note: PDF has "ูุงุนูุฉ" for both 1 and 2
                '3': "ูุทุจู ุงูุณูุงุณุงุช ูุงูุฃูุธูุฉ ูุงูููุงุฆุญ ุงูููุธูุฉ ููุนูู ุจุตูุฑุฉ <span class='highlight'>ููุงุณุจุฉ</span>.",
                '4': "ูุทุจู ุงูุณูุงุณุงุช ูุงูุฃูุธูุฉ ูุงูููุงุฆุญ ุงูููุธูุฉ ููุนูู ุจุตูุฑุฉ <span class='highlight'>ูุญุฏูุฏุฉ</span>.",
                '5': "ูุทุจู ุงูุณูุงุณุงุช ูุงูุฃูุธูุฉ ูุงูููุงุฆุญ ุงูููุธูุฉ ููุนูู ุจุตูุฑุฉ <span class='highlight'>ูุงุฏุฑุฉ</span>."
            },
            '13': { // ุงููุจุงุฏุฑุงุช
                '1': "ููุฏู ูุจุงุฏุฑุงุช ูุนุงูุฉ ูุฏุนู ูุชุญุณูู ุงูุนูููุฉ ุงูุชุนููููุฉุ ููุง ูุชููุฒ ุจุงูุชูุงุนู ุงูุฅูุฌุงุจู ูู <span class='highlight'>ุฌููุน</span> ุงูุฃูุดุทุฉ ุงูุชุฑุจููุฉ ูุงููุฌุชูุน ุงููุญูู.",
                '2': "ููุฏู ูุจุงุฏุฑุงุช ูุงุนูุฉ ูุฏุนู ูุชุญุณูู ุงูุนูููุฉ ุงูุชุนููููุฉุ ููุง ูุชููุฒ ุจุงูุชูุงุนู ุงูุฅูุฌุงุจู ูู <span class='highlight'>ูุนุธู</span> ุงูุฃูุดุทุฉ ุงูุชุฑุจููุฉ ูุงููุฌุชูุน ุงููุญูู.",
                '3': "ููุฏู ูุจุงุฏุฑุงุช ููุงุฆูุฉ ูุฏุนู ูุชุญุณูู ุงูุนูููุฉ ุงูุชุนููููุฉุ ููุง ูุชูุงุนู ุฅูุฌุงุจูุง ูู <span class='highlight'>ุฃุบูุจ</span> ุงูุฃูุดุทุฉ ุงูุชุฑุจููุฉ ูุงููุฌุชูุน ุงููุญูู.",
                '4': "ููุฏู ูุจุงุฏุฑุงุช ูุญุฏูุฏุฉ ูุฏุนู ูุชุญุณูู ุงูุนูููุฉ ุงูุชุนููููุฉุ ููุง ูุชูุงุนู ุจุดูู <span class='highlight'>ูุญุฏูุฏ</span> ูุน ุงูุฃูุดุทุฉ ุงูุชุฑุจููุฉ ูุงููุฌุชูุน ุงููุญูู.",
                '5': "<span class='highlight'>ูุงุฏุฑุง</span> ูุง ููุฏู ูุจุงุฏุฑุงุช ูุฏุนู ูุชุญุณูู ุงูุนูููุฉ ุงูุชุนููููุฉ ููุง ุฃู ุชูุงุนูู ูุน ุงูุฃูุดุทุฉ ุงูุชุฑุจููุฉ ูุงููุฌุชูุน ุงููุญูู <span class='highlight'>ูุญุฏูุฏ ุฌุฏุง</span>."
            }
        };


        const instructionalRecommendations = {
            '1': "ุงุญุฑุต ุนูู ุชูููุน ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณ ูุงูุชูููู ูุถูุงู ุงูุชุณุงุจ ุฌููุน ุงูุทูุจุฉ ููููุงุฑุงุช ุงูุญุฑููุฉ ูุงููุนุงุฑู ุงููุฑุชุจุทุฉ ุจุงููุงุฏุฉ ุจูุงุนููุฉ.",
            '2': "ุงุนูู ุนูู ูุชุงุจุนุฉ ุงูุชูุฏู ุงููุฑุฏู ูุฌููุน ุงูุทูุจุฉุ ุจูู ูููู ุฐูู ุงูุงุญุชูุงุฌุงุช ุงูุชุนููููุฉุ ููุฏู ุงูุฏุนู ุงููุงุฒู ูุถูุงู ุชุทูุฑ ุฃุฏุงุฆูู ุงูููุงุฑู ูุงูุฎุทุทู ุจุดูู ูุณุชูุฑ ุฎูุงู ุงูุญุตุฉ.",
            '3': "ุงุญุฑุต ุนูู ุชูููู ุฌููุน ุทูุจุชู ูู ุชุทุจูู ููุงุฑุงุช ุงูุชุนูู ุงููุชููุนุฉ (ุงูุฐุงุชูุ ุงูุชุนุงูููุ ุงูุฑููู) ูุชูููุฉ ููุงุฑุงุช ุงูุชูููุฑ ุงูุนููุง ูุฏูููุ ูุน ุงูุชุฃููุฏ ุนูู ุฑุจุท ูุง ูุชุนููููู ุจูุงูุน ุญูุงุชูู ูุชุนููู ุฃุซุฑ ุงูุชุนูู.",
            '4': "ุงุนูู ุนูู ุชุฑุณูุฎ ุงููููุฉ ุงูุนูุงููุฉ ูุงูููู ุงูุฅูุณุงููุฉ ุงููุดุชุฑูุฉ ูู ูููุณ ุทูุจุชูุ ูุดุฌุนูู ุนูู ุงูุงูุชุฒุงู ุจูุง ุณููููุง ูููุงุฑุณุฉู ูู ุฌููุน ุงูููุงูู ุฏุงุฎู ุงููุฏุฑุณุฉ ูุฎุงุฑุฌูุง.",
            '5': "ุชุฃูุฏ ุจุงุณุชูุฑุงุฑ ูู ุณูุงูุฉ ุงูุฃุฏูุงุช ูุงููุฑุงูู ุงูุฑูุงุถูุฉุ ูุนุฒุฒ ูุฏู ุงูุทูุจุฉ ุฃูููุฉ ุงููุญุงูุธุฉ ุนูู ุจูุฆุฉ ุชุนูู ุขููุฉ ููุธููุฉ.",
            '6': "ุงุณุชูุฑ ูู ุชุฎุทูุท ุงูุฏุฑูุณ ุจุดูู ูููุฌู ููุชุณูุณูุ ูุน ุฑุจุท ุงูุฃูุฏุงู ุจุงูุฎุทุฉ ุงููุตููุฉ ูุชูููุน ุงูุงุณุชุฑุงุชูุฌูุงุช ูุงูุฃูุดุทุฉ ูุชูุจูุฉ ุงุญุชูุงุฌุงุช ุฌููุน ุงูุทูุจุฉ.",
            '7': "ูุธู ุงุณุชุฑุงุชูุฌูุงุช ูุนุงูุฉ ูุฅุฏุงุฑุฉ ูุชูุธูู ุงููุดุงุท ุงูุจุฏููุ ูุงุณุชุซูุฑ ููุช ุงูุญุตุฉ ุจุงููุงูู ูู ููุงุฑุณุฉ ุงูุฃูุดุทุฉ ุงูุญุฑููุฉ ุงููุงุฏูุฉ ูุฑูุน ุฏุงูุนูุฉ ุงูุทูุจุฉ.",
            '8': "ุงุญุฑุต ุนูู ุชูุธูู ุงุณุชุฑุงุชูุฌูุงุช ุชุฏุฑูุณ ูุชููุนุฉ ูููุงุณุจุฉ ูููุดุงุท ุงูุจุฏููุ ุจูุง ูุถูู ุงุณุชูุงุฏุฉ ุฌููุน ุงูุทูุจุฉ ูู ุชุนููู ุชุนูููู ููููุงุฑุงุช ุงูุญุฑููุฉ.",
            '9': "ุงุนูู ุนูู ุชูุนูู ุฌููุน ุงููุตุงุฏุฑ ูุงูููุงุฑุฏ ุงูุชุนููููุฉ ุงููุชุงุญุฉุ ุจูุง ูู ุฐูู ุงูุฃุฏูุงุช ูุงูุฃุฌูุฒุฉ ุงูุฑูุงุถูุฉ ูุงูููุตุงุช ุงูุฑูููุฉุ ูุฅุซุฑุงุก ุชุฌุฑุจุฉ ุงูุชุนูู ูุฏู ุงูุทูุจุฉ.",
            '10': "ูุธู ุฃุณุงููุจ ุชูููู ูุชููุนุฉ ูููุงุณุจุฉ ููุฃุฏุงุก ุงูุญุฑููุ ูุน ุชูุฏูู ุชุบุฐูุฉ ุฑุงุฌุนุฉ ููุฑูุฉ ูุจูุงุกุฉ ูุฏุนู ุชูุฏู ุฌููุน ุงูุทูุจุฉ ูุชูุจูุฉ ุงููุฑูู ุงููุฑุฏูุฉ ุจูููู.",
            '11': "ุงุณุชูุฑ ูู ุชูููู ุฃุฏุงุฆู ุฐุงุชููุง ูุงูุชุฃูู ูู ููุงุฑุณุงุชู ุงูุชุฏุฑูุณูุฉุ ููุธู ูุชุงุฆุฌ ูุฐุง ุงูุชุฃูู ูู ุชุทููุฑ ุฎุทุทู ูุฃุณุงููุจู ูุชุญุณูู ุชุนูู ุงูุทูุจุฉ ุจุดูู ูุณุชูุฑ.",
            '12': "ุงูุชุฒู ุฏุงุฆูุงู ุจุฃุฎูุงููุงุช ุงููููุฉ ูุงูุณูุงุณุงุช ูุงูููุงุฆุญ ุงูููุธูุฉ ููุนููุ ููู ูููุฐุฌุงู ูุญุชุฐู ุจู ููุทูุจุฉ ูุงูุฒููุงุก.",
            '13': "ุจุงุฏุฑ ุจุชูููุฐ ุฃูุดุทุฉ ููุณุงุจูุงุช ุฑูุงุถูุฉ ูุงุนูุฉ ูู ุงููุฌุชูุน ุงููุฏุฑุณูุ ูุนุฒุฒ ุชูุงุนูู ุงูุฅูุฌุงุจู ูุน ุงูุฃูุดุทุฉ ุงูุชุฑุจููุฉ ูุงููุฌุชูุน ุงููุญูู."
        };


        // --- All JS Functions Definition ---
        // VIEWS
        function toggleView(viewId) {
            document.querySelectorAll('#form-view, #dashboard-view, #saved-reports-view').forEach(view => {
                view.classList.remove('active');
            });
            document.getElementById(viewId).classList.add('active');

            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`.nav-tab[onclick="toggleView('${viewId}')"]`).classList.add('active');

            if (viewId === 'saved-reports-view') {
                renderSavedReports();
            }
        }
        
        // SCORING
        function updateScore(itemId, score) {
            const mainScoreDisplay = document.getElementById(`score-${itemId}`);
            mainScoreDisplay.textContent = score;
            updateScoreColor(mainScoreDisplay, score);

            // Update rating buttons UI
            const ratingContainer = document.querySelector(`#item-${itemId} .rating-selector`);
            ratingContainer.querySelectorAll('.rating-btn').forEach(btn => {
                btn.classList.remove('active');
                if(btn.dataset.score == score) {
                    btn.classList.add('active');
                }
            });

            // Update notes with description
            const notesDiv = document.getElementById(`notes-${itemId}`);
            if(detailedDescriptions[itemId] && detailedDescriptions[itemId][score]) {
                notesDiv.innerHTML = detailedDescriptions[itemId][score];
            } else {
                notesDiv.innerHTML = '';
            }
        }
        
        function updateScoreColor(element, score) {
            element.style.backgroundColor = '#f0f2f5';
            element.style.color = '#333';
            if (score == 1) { element.style.backgroundColor = '#d4edda'; element.style.color = '#155724'; } // Excellent
            else if (score == 2) { element.style.backgroundColor = '#cce5ff'; element.style.color = '#004085'; } // Good
            else if (score == 3) { element.style.backgroundColor = '#fff3cd'; element.style.color = '#856404'; } // Appropriate
            else if (score == 4) { element.style.backgroundColor = '#f8d7da'; element.style.color = '#721c24'; } // Inappropriate
            else if (score == 5) { element.style.backgroundColor = '#dc3545'; element.style.color = '#fff'; } // Urgent
        }
        
        
        // FORM & DATA
        function generateEvaluationForm() {
            const formContainer = document.getElementById('evaluationForm');
            formContainer.innerHTML = '';
            let currentDomain = '';
            let detailsElement;

            evaluationItems.forEach(item => {
                if(item.domain !== currentDomain) {
                    currentDomain = item.domain;
                    detailsElement = document.createElement('details');
                    detailsElement.open = true;
                    const summary = document.createElement('summary');
                    summary.textContent = currentDomain;
                    detailsElement.appendChild(summary);
                    formContainer.appendChild(detailsElement);
                }

                const itemCardHTML = `
                    <div class="item-card" id="item-${item.id}">
                        <div class="item-header">
                            <h4>${item.id}. ${item.title} <br><small>${item.desc}</small></h4>
                            <div class="score" id="score-${item.id}">3</div>
                        </div>
                        <div class="rating-selector">
                           <button type="button" class="rating-btn score-1" data-score="1" onclick="updateScore(${item.id}, 1)">ูุชููุฒ</button>
                           <button type="button" class="rating-btn score-2" data-score="2" onclick="updateScore(${item.id}, 2)">ุฌูุฏ</button>
                           <button type="button" class="rating-btn score-3 active" data-score="3" onclick="updateScore(${item.id}, 3)">ููุงุฆู</button>
                           <button type="button" class="rating-btn score-4" data-score="4" onclick="updateScore(${item.id}, 4)">ุบูุฑ ููุงุฆู</button>
                           <button type="button" class="rating-btn score-5" data-score="5" onclick="updateScore(${item.id}, 5)">ุชุฏุฎู ุณุฑูุน</button>
                        </div>
                        <div class="notes-wrapper">
                            <div id="notes-${item.id}" class="item-notes" contenteditable="true"></div>
                            ${recognition ? `<button type="button" class="mic-btn" onclick="startDictation('notes-${item.id}', this)">๐ค</button>` : ''}
                        </div>
                    </div>
                `;
                detailsElement.innerHTML += itemCardHTML;
            });
             evaluationItems.forEach(item => {
                updateScore(item.id, 3); // Set initial state
            });
        }
        
        function getSchoolName() {
            const schoolSelect = document.getElementById('school');
            return schoolSelect.value === 'other' ? document.getElementById('school-other').value.trim() : schoolSelect.value;
        }

        function getTeacherName() {
            return document.getElementById('teacherName').value.trim();
        }
        
        function populateDropdown(selectElement, dataArray, placeholderText) {
            selectElement.innerHTML = `<option value="">${placeholderText}</option>`;
            dataArray.forEach(item => {
                const option = document.createElement('option');
                option.value = item;
                option.textContent = item;
                selectElement.appendChild(option);
            });
            selectElement.innerHTML += `<option value="other">ุฃุฎุฑู...</option>`;
        }
        
        function handleOtherOption(selectElement, otherInputElement) {
            if (selectElement.value === 'other') {
                otherInputElement.style.display = 'block';
            } else {
                otherInputElement.style.display = 'none';
                otherInputElement.value = '';
            }
        }

        // ACTIONS (Print, Export, Report)
        function prepareOfficialPrint() {
            // This function is complex due to the new print layout
        }


        function printOfficialReport() {
            prepareOfficialPrint();
            window.print();
        }
        
        function exportToWord() {
            prepareOfficialPrint();
            const visitNumber = document.getElementById('visitNumber').value.trim() || 'ุฒูุงุฑุฉ';
            const schoolName = getSchoolName() || 'ูุฏุฑุณุฉ';
            const teacherName = getTeacherName() || 'ูุนูู';
            const fileName = `${visitNumber} - ${schoolName} - ${teacherName}.docx`;

            const content = `
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                    <style>
                        body { font-family: 'Times New Roman', Times, serif; direction: rtl; }
                        /* Add all print styles here */
                    </style>
                </head>
                <body>${document.getElementById("printView").innerHTML}</body>
                </html>
            `;
            const converted = htmlDocx.asBlob(content, {
                orientation: 'portrait',
                margins: { top: 720, right: 720, bottom: 720, left: 720 }
            });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(converted);
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
       
        function generateReport() {
            let strengths = [];
            let developments = [];
            let recommendations = [];

            evaluationItems.forEach(item => {
                const score = parseInt(document.getElementById(`score-${item.id}`).textContent);
                const notes = document.getElementById(`notes-${item.id}`).innerHTML;
                
                if (score <= 2) {
                    strengths.push({title: item.title, standard: item.standard, notes: notes});
                }
                if (score >= 4) {
                    developments.push({title: item.title, standard: item.standard, notes: notes});
                    recommendations.push({ id: item.id, title: item.title, standard: item.standard });
                }
                if (score === 3) {
                     recommendations.push({ id: item.id, title: item.title, standard: item.standard });
                }
            });
            
            let recommendationsText = "ููุตู ุงููุนูู ุจุงูุขุชู:\n\n";
            recommendations.forEach(rec => {
                 if(instructionalRecommendations[rec.id]) {
                     recommendationsText += `โข ${rec.standard} - ${rec.title}: ${instructionalRecommendations[rec.id]}\n\n`;
                 }
            });
            recommendationsText += "ูุงููู ููู ุงูุชูููู.";

            document.getElementById('strengthsContent').value = strengths.slice(0, 4).map(s => `${s.standard}: ${s.notes.replace(/<[^>]*>?/gm, '')}`).join('\n\n');
            document.getElementById('developmentContent').value = developments.slice(0, 4).map(d => `${d.standard}: ${d.notes.replace(/<[^>]*>?/gm, '')}`).join('\n\n');
            document.getElementById('recommendationsContent').value = recommendationsText;

            document.getElementById('reportSection').style.display = 'block';
            document.getElementById('reportSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        function startDictation(textareaId, button) {
            if (!recognition) {
                alert('ุนุฐุฑุงูุ ูุชุตูุญู ูุง ูุฏุนู ุฎุงุตูุฉ ุงูุฅููุงุก ุงูุตูุชู.');
                return;
            }
            
            const notesDiv = document.getElementById(textareaId);
            button.classList.add('recording');
            button.textContent = '๐ด';

            recognition.start();

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                 notesDiv.innerHTML += (notesDiv.textContent.length > 0 ? ' ' : '') + transcript;
            };

            recognition.onspeechend = function() {
                recognition.stop();
            };

            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                alert(`ุญุฏุซ ุฎุทุฃ ูู ุงูุชุนุฑู ุนูู ุงูุตูุช: ${event.error}`);
            };

            recognition.onend = function() {
                button.classList.remove('recording');
                button.textContent = '๐ค';
            };
        }


        // MODAL & RESET
        function showResetModal() {
            document.getElementById('reset-modal').style.display = 'flex';
        }

        function hideResetModal() {
            document.getElementById('reset-modal').style.display = 'none';
        }

        function performReset() {
            clearForm();
            hideResetModal();
            displayStatusMessage('ุชู ูุณุญ ุงููููุฐุฌ ุงูุญุงูู ุจูุฌุงุญ.', 'green');
        }
        
        function clearForm() {
            document.getElementById('evaluationForm').reset();
             const schoolSelect = document.getElementById('school');
            schoolSelect.selectedIndex = 0;
            schoolSelect.dispatchEvent(new Event('change'));
             document.querySelectorAll('.info-grid input, .report-content-area').forEach(input => {
                 input.value = '';
            });
            evaluationItems.forEach(item => {
                 updateScore(item.id, 3);
            });
            document.getElementById('reportSection').style.display = 'none';
        }


        // DATA PERSISTENCE & ARCHIVING
        function displayStatusMessage(message, color) {
            const statusElement = document.getElementById('status-message');
            statusElement.textContent = message;
            statusElement.style.color = color;
            statusElement.style.opacity = 1;
            setTimeout(() => { statusElement.style.opacity = 0; }, 3000);
        }
        
        function savePermanentReport() {
            const teacherName = getTeacherName();
            const visitDate = document.getElementById('visitDate').value;
            if (!teacherName || !visitDate) {
                alert('ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ุงููุนูู ูุชุงุฑูุฎ ุงูุฒูุงุฑุฉ ูุจู ุงูุญูุธ.');
                return;
            }
            
            const reportId = `visit_v5_${Date.now()}`;
            const reportData = {
                id: reportId,
                teacherName: teacherName,
                visitDate: visitDate,
                school: getSchoolName(),
                formData: {}
            };

            document.querySelectorAll('input, select, textarea').forEach(el => {
                if (el.id) reportData.formData[el.id] = el.value;
            });
            evaluationItems.forEach(item => {
                reportData.formData[`score-${item.id}`] = document.getElementById(`score-${item.id}`).textContent;
                reportData.formData[`notes-${item.id}`] = document.getElementById(`notes-${item.id}`).innerHTML;
            });

            localStorage.setItem(reportId, JSON.stringify(reportData));
            
            const visitDataForDashboard = { date: visitDate, scores: {} };
            for(let i = 1; i <= evaluationItems.length; i++) {
                 const scoreEl = document.getElementById(`score-${i}`);
                 if (scoreEl) {
                    visitDataForDashboard.scores[`item-${i}`] = parseInt(scoreEl.textContent) || 3;
                 }
            }
            const teacherArchiveKey = `teacher_archive_v5_${teacherName}`;
            let archive = JSON.parse(localStorage.getItem(teacherArchiveKey)) || [];
            const existingVisitIndex = archive.findIndex(v => v.date === visitDate);

            if (existingVisitIndex > -1) {
                archive[existingVisitIndex] = visitDataForDashboard;
            } else {
                archive.push(visitDataForDashboard);
            }
            archive.sort((a, b) => new Date(a.date) - new Date(b.date));
            localStorage.setItem(teacherArchiveKey, JSON.stringify(archive));

            displayStatusMessage(`ุชู ุญูุธ ุงูุชูุฑูุฑ ูููุนูู: ${teacherName} ุจูุฌุงุญ!`, '#3f51b5');
        }

        function loadPermanentReport(reportKey) {
            const data = JSON.parse(localStorage.getItem(reportKey));
            if (data && data.formData) {
                clearForm(); 
                Object.keys(data.formData).forEach(key => {
                    const el = document.getElementById(key);
                    if (el) {
                        if (el.classList.contains('item-notes')) {
                             el.innerHTML = data.formData[key];
                        } else if (el.tagName === 'DIV' && el.classList.contains('score')) {
                            el.textContent = data.formData[key];
                        } else {
                            el.value = data.formData[key];
                        }
                        if (el.tagName === 'SELECT') {
                            el.dispatchEvent(new Event('change'));
                        }
                    }
                });

                evaluationItems.forEach(item => {
                    const score = parseInt(data.formData[`score-${item.id}`] || 3);
                    updateScore(item.id, score);
                });
                
                toggleView('form-view');
                displayStatusMessage(`ุชู ุชุญููู ุงูุชูุฑูุฑ ุงููุญููุธ.`, '#007bff');
            }
        }

        function deletePermanentReport(reportKey) {
            const data = JSON.parse(localStorage.getItem(reportKey));
             if (!data || !confirm(`ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุชูุฑูุฑ ูููุนูู ${data.teacherName} ุจุชุงุฑูุฎ ${data.visitDate}ุ ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก.`)) {
                return;
            }

            localStorage.removeItem(reportKey);

            const teacherArchiveKey = `teacher_archive_v5_${data.teacherName}`;
            let archive = JSON.parse(localStorage.getItem(teacherArchiveKey)) || [];
            const updatedArchive = archive.filter(visit => visit.date !== data.visitDate);
            if (updatedArchive.length > 0) {
                localStorage.setItem(teacherArchiveKey, JSON.stringify(updatedArchive));
            } else {
                localStorage.removeItem(teacherArchiveKey); 
            }

            renderSavedReports(); 
            displayStatusMessage(`ุชู ุญุฐู ุงูุชูุฑูุฑ ุจูุฌุงุญ.`, 'red');
        }


        function saveVisitorData() {
            const visitorData = {
                name: document.getElementById('visitorName').value,
                position: document.getElementById('visitorPosition').value
            };
            localStorage.setItem('visitorData_v5', JSON.stringify(visitorData));
        }

        function loadVisitorData() {
            const visitorData = JSON.parse(localStorage.getItem('visitorData_v5'));
            if(visitorData) {
                document.getElementById('visitorName').value = visitorData.name || '';
                document.getElementById('visitorPosition').value = visitorData.position || '';
            }
        }
        
        function saveTemplate() {
            const templateName = prompt("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ูููุงูุจ:");
            if (!templateName) return;

            const data = {};
            document.querySelectorAll('input, select').forEach(el => {
                if (el.id) data[el.id] = el.value;
            });
             evaluationItems.forEach(item => {
                data[`score-${item.id}`] = document.getElementById(`score-${item.id}`).textContent;
                data[`notes-${item.id}`] = document.getElementById(`notes-${item.id}`).innerHTML;
            });


            let templates = JSON.parse(localStorage.getItem('evaluationTemplates_v5')) || {};
            templates[templateName] = data;
            localStorage.setItem('evaluationTemplates_v5', JSON.stringify(templates));
            populateTemplateDropdown();
            displayStatusMessage(`ุชู ุญูุธ ุงููุงูุจ "${templateName}" ุจูุฌุงุญ.`, 'green');
        }

        function loadTemplate() {
            const templateName = document.getElementById('template-select').value;
            if (!templateName) return;

            const templates = JSON.parse(localStorage.getItem('evaluationTemplates_v5')) || {};
            const data = templates[templateName];

            if (data) {
                Object.keys(data).forEach(key => {
                    const el = document.getElementById(key);
                    if (el) {
                        if(el.classList.contains('item-notes')) {
                            el.innerHTML = data[key];
                        }
                        else if (el.tagName === 'DIV' && el.classList.contains('score')) {
                             el.textContent = data[key];
                        }
                        else el.value = data[key];

                        if (el.tagName === 'SELECT') {
                            el.dispatchEvent(new Event('change'));
                        }
                    }
                });
                evaluationItems.forEach(item => {
                    const score = parseInt(document.getElementById(`score-${item.id}`).textContent);
                    updateScore(item.id, score);
                });
                displayStatusMessage(`ุชู ุชุญููู ุงููุงูุจ "${templateName}".`, '#007bff');
            }
        }

        function populateTemplateDropdown() {
            const select = document.getElementById('template-select');
            const templates = JSON.parse(localStorage.getItem('evaluationTemplates_v5')) || {};
            select.innerHTML = '<option value="">ุงุฎุชุฑ ูุงูุจูุง...</option>';
            for (const name in templates) {
                select.innerHTML += `<option value="${name}">${name}</option>`;
            }
        }

        // DASHBOARD & SAVED REPORTS
        function renderSavedReports() {
            const listContainer = document.getElementById('saved-reports-list');
            const noReportsMessage = document.getElementById('no-saved-reports-message');
            listContainer.innerHTML = '';
            let reportsFound = false;

            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('visit_v5_')) {
                    reportsFound = true;
                    const data = JSON.parse(localStorage.getItem(key));
                    const schoolName = data.school === 'other' ? data.formData['school-other'] : data.school;
                    
                    const card = document.createElement('div');
                    card.className = 'saved-report-card';
                    card.innerHTML = `
                        <div class="saved-report-info">
                            <strong>ุงููุนูู:</strong> ${data.teacherName}<br>
                            <strong>ุงููุฏุฑุณุฉ:</strong> ${schoolName}<br>
                            <strong>ุงูุชุงุฑูุฎ:</strong> ${data.visitDate}
                        </div>
                        <div class="saved-report-actions">
                            <button class="generate-btn" onclick="loadPermanentReport('${key}')">ุชุญููู</button>
                            <button class="reset-btn" onclick="deletePermanentReport('${key}')">ุญุฐู</button>
                        </div>
                    `;
                    listContainer.appendChild(card);
                }
            }
            
            if (noReportsMessage) {
                noReportsMessage.style.display = reportsFound ? 'none' : 'block';
            }
        }

        function loadTeacherDashboard() {
            const teacherName = document.getElementById('teacher-dashboard-name').value.trim();
             if (!teacherName) {
                alert('ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ูุนูู.');
                return;
            }

            const teacherArchiveKey = `teacher_archive_v5_${teacherName}`;
            const archive = JSON.parse(localStorage.getItem(teacherArchiveKey));
            
            const chartContainer = document.getElementById('chart-container');
            const noDataMessage = document.getElementById('no-data-message');

            if (!archive || archive.length === 0) {
                chartContainer.style.display = 'none';
                if(noDataMessage) noDataMessage.style.display = 'block';
                 if (performanceChartInstance) {
                    performanceChartInstance.destroy();
                }
                return;
            }

            chartContainer.style.display = 'block';
            if(noDataMessage) noDataMessage.style.display = 'none';

            const labels = archive.map(visit => visit.date);
            const datasets = [];
            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#8D6E63', '#EC407A', '#7E57C2', '#26A69A', '#D4E157', '#FF7043', '#78909C', '#5C6BC0'];

            evaluationItems.forEach((item, index) => {
                 datasets.push({
                    label: item.title,
                    data: archive.map(visit => visit.scores[`item-${item.id}`] || 0),
                    borderColor: colors[index % colors.length],
                    backgroundColor: colors[index % colors.length] + '33',
                    fill: false,
                    tension: 0.1
                });
            });

            const ctx = document.getElementById('performanceChart').getContext('2d');
            if (performanceChartInstance) {
                performanceChartInstance.destroy();
            }
            performanceChartInstance = new Chart(ctx, {
                type: 'line',
                data: { labels, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: `ุชุทูุฑ ุฃุฏุงุก ุงููุนูู: ${teacherName}`, font: { size: 18, family: 'Tajawal' } },
                        legend: { position: 'top', labels: { font: { family: 'Tajawal' } } }
                    },
                    scales: {
                        y: { 
                            beginAtZero: false,
                            min: 1,
                            max: 5,
                            reverse: true,
                            ticks: { 
                                stepSize: 1,
                                callback: function(value, index, values) {
                                    const labels = ['ูุชููุฒ', 'ุฌูุฏ', 'ููุงุฆู', 'ุบูุฑ ููุงุฆู', 'ุชุฏุฎู ุณุฑูุน'];
                                    return labels[value - 1];
                                }
                             }, 
                            title: { display: true, text: 'ุงูุชูุฏูุฑ' } 
                        },
                        x: { title: { display: true, text: 'ุชุงุฑูุฎ ุงูุฒูุงุฑุฉ' } }
                    }
                }
            });
        }
        
        // --- Document Ready / Initial Setup ---
        document.addEventListener('DOMContentLoaded', function() {
            generateEvaluationForm();

            const schoolSelect = document.getElementById('school');
            const schoolOtherInput = document.getElementById('school-other');
            populateDropdown(schoolSelect, schoolsList, 'ุงุฎุชุฑ ุงููุฏุฑุณุฉ...');
            schoolSelect.addEventListener('change', () => handleOtherOption(schoolSelect, schoolOtherInput));

            populateTemplateDropdown();
            loadVisitorData();
            
            document.getElementById('confirm-reset-btn').addEventListener('click', performReset);
            document.getElementById('cancel-reset-btn').addEventListener('click', hideResetModal);
            document.getElementById('reset-modal').addEventListener('click', (e) => {
                if (e.target.id === 'reset-modal') hideResetModal();
            });

            document.getElementById('visitorName').addEventListener('input', saveVisitorData);
            document.getElementById('visitorPosition').addEventListener('input', saveVisitorData);

            // Set initial view
            toggleView('form-view');
        });
    </script>
</body>
</html>

